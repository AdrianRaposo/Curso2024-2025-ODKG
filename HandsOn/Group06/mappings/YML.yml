prefixes:
  rml: "http://semweb.mmlab.be/ns/rml#"
  rr: "http://www.w3.org/ns/r2rml#"
  ql: "http://www.w3.org/ns/ql#"
  mair: "http://MadridAirQuality.org/ontology#"
  fno: "https://w3id.org/function/ontology#"
  fnml: "http://semweb.mmlab.be/ns/fnml#"

mappings:
  StationMapping:
    rml:logicalSource:
      rml:source: "/../csv/ODKG-Group06-AirQualityDataset-updated;csv"
      rml:referenceFormulation: ql:CSV

    rr:subjectMap:
      rr:template: "http://MadridAirQuality.org/ontology/station/{PROVINCE}-{MUNICIPALITY}-{STATION}"
      rr:class: mair:Station

    rr:predicateObjectMap:
      - rr:predicate: mair:hasStreet
        rr:objectMap:
          rr:parentTriplesMap: StreetMapping
          rr:joinCondition:
            rr:child: "STATION"
            rr:parent: "CODE"

      - rr:predicate: mair:hasProvince
        rr:objectMap:
          rml:reference: "PROVINCE"
          rr:constant: "Comunidad de Madrid"
          rr:termType: rr:Literal
          rr:condition:
            rr:predicateMap:
              rml:reference: "PROVINCE"
            rr:constant: "28"

      - rr:predicate: mair:hasMunicipality
        rr:objectMap:
          rml:reference: "MUNICIPALITY"
          rr:constant: "Madrid"
          rr:termType: rr:Literal
          rr:condition:
            rr:predicateMap:
              rml:reference: "MUNICIPALITY"
            rr:constant: "79"

      - rr:predicate: mair:hasObservation
        rr:objectMap:
          rr:parentTriplesMap: MeasurementMapping
          rr:child: "MAGNITUDE"
          rr:parent: "MAGNITUDE"

  MeasurementMapping:
    rr:subjectMap:
      rr:template: "http://example.org/observation/{PROVINCE}-{MUNICIPALITY}-{STATION}/{MAGNITUDE}/{YEAR}-{MONTH}/D{D01}"
      rr:class: mair:Observation

    rr:predicateObjectMap:
      - rr:predicate: mair:hasParameter
        rr:objectMap: MagnitudeMapping

      - rr:predicate: mair:hasTechnique
        rr:objectMap:
          rml:reference: "TECHNIQUE"

      # Daily measurements mapping
      - rr:predicate: mair:hasValue
        rr:objectMap:
          rml:reference: "D01"
      - rr:predicate: mair:observationDate
        rr:objectMap:
          rr:template: "{YEAR}-{MONTH}-01"

      - rr:predicate: mair:hasValue
        rr:objectMap:
          rml:reference: "D02"
      - rr:predicate: mair:observationDate
        rr:objectMap:
          rr:template: "{YEAR}-{MONTH}-02"

      - rr:predicate: mair:hasValue
        rr:objectMap:
          rml:reference: "D03"
      - rr:predicate: mair:observationDate
        rr:objectMap:
          rr:template: "{YEAR}-{MONTH}-03"

      # More daily mappings for D04 to D31 as required...

  MagnitudeMapping:
    rml:logicalSource:
      rml:source: "/csv/Magnitude-Relationship;csv"
      rml:referenceFormulation: ql:CSV

    rr:subjectMap:
      rr:template: "http://MadridAirQuality/ontology/magnitude/{MAGNITUDE}"
      rr:class: mair:Magnitude

    rr:predicateObjectMap:
      - rr:predicate: mair:hasMagnitude
        rr:objectMap:
          rml:reference: "MAGNITUDE"

      - rr:predicate: mair:hasParameterName
        rr:objectMap:
          rml:reference: "PARAMETER_NAME"

      - rr:predicate: mair:hasMeasurementUnit
        rr:objectMap:
          rml:reference: "MEASUREMENT_UNIT"

  StreetMapping:
    rml:logicalSource:
      rml:source: "/csv/LocationCode-Relationship;csv"
      rml:referenceFormulation: ql:CSV

    rr:subjectMap:
      rr:template: "http://MadridAirQuality/ontology/sampling_location/{CODE}"
      rr:class: mair:Street

    rr:predicateObjectMap:
      - rr:predicate: mair:hasLocationCode
        rr:objectMap:
          rml:reference: "CODE"

      - rr:predicate: mair:hasSamplingLocation
        rr:objectMap:
          rml:reference: "SAMPLING_LOCATION"
